<!doctype html>
<!--

Welcome to the Indexbook Publishing Kit.
Create beautiful books using markdown.

1. Link to Indexbook Manual

want:
dirtslayer.github.io/Indexbook/The_Indexbook_Manual/
dirtslayer.github.io/Indexbook?f=The_Indexbook_Manual


2. There is a LICENSE file adjacent this file which applies to the Indexbook repository
   AND you should understand the LICENSE please

3. YOU should create issues, pull requests and forks please. PR's should include 
   addding your name to list of contributors, I would be thrilled if someone made a pr
   on this repo

-->
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <title>Indexbook</title>
  <link rel="stylesheet" crossorigin="anonymous" referrerpolicy="no-referrer" 
    href="https://unpkg.com/github-markdown-css/github-markdown-light.css" >
  
  <!-- @import url('https://fonts.googleapis.com/css2?family=Cedarville+Cursive&display=swap'); -->
  


<!--


  display: flex;
  align-items: center; /* Vertical alignment */
  justify-content: center; /* Horizontal alignment */
  height: 100vh; /* Full viewport height for demonstration */
  -->

  
  <style>

body {
  margin: 0;
}
    
ul.flow-layout {
  display: flex;
  flex-wrap: wrap;
  flex-direction: row;
  list-style-type: none;
  gap: 5em;
  background-color: white;

 // transform: scale(0.5,0.5);
  // transform-origin: top left;

  width : 190%;
}

li.flow-layout {
  display: flex;
  align-items: left;
  
  flex-direction: column;
  background-color: grey;

  height: 624px;

  margin: 0px;
}
    
.thumb {
  
  width: 425px;
  height: 600px;
  background-color: ghostwhite; // ghostwhiter mention
  border: 4px solid black;
  overflow: hidden;
}

img[src*="#200"] {  // hack to pass image width from md using bookmarks
  width:200px;
}

  </style>
</head>
<body ><a  href='index_include.md'  > index </a>
<a  id="prev"  href=''  > prev </a>
<a  id="next"  href=''  > next  </a>
<a  id="raw"  href=''  > raw </a>
<div><h3><i>Indexbook</i></h3>
<div id="Index"></div>
</div>

  
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked-base-url"></script>
<script>


function preventDefaultLinks () {
  const myLinks = document.querySelectorAll("a");
  for (const link of myLinks) {
    link.onclick = (e) => {
      e.preventDefault();
      handleaclick(
        e.target.getAttribute("href")
      );
    };
  }
}

preventDefaultLinks();

async function handleaclick(f) {
  if ( f === 'index_include.md' ) {
    const include_file = await fetch(f).then((response) => response.text());
    const include_lines = include_file.split(/\r?\n/);
    const include_prom = [];
    include_lines.forEach((line) => {
       include_prom.push(fetch(line));
    });
    const pages = [];
    await Promise.all(include_prom).then( async (r) => {
        r.forEach( async (resp) => {
          pages.push( resp.text());
        });        
    });
    await Promise.all(pages).then((p)=>{
      let i = 0;
      let indexul = "<ul class=\"flow-layout\">"; 
      p.forEach( (pt) => { 
        indexul += "<li class=\"flow-layout\" >";
        // console.log('\n******\n' + include_lines[i] + '\n=======\n' + pt);
        indexul += "<a href=\"" + include_lines[i] + "\">" + include_lines[i].trim() + "</a>";
        indexul += "<div class=\"thumb markdown-body\">";



const base = "./" + include_lines[i].split("/").slice(0,-1).join("/") + "/";
marked.use(markedBaseUrl.baseUrl('/'));
marked.use(markedBaseUrl.baseUrl(base));
indexul += marked.parse(pt);
        
        
        
        
        indexul += "</div></li>";
        i++;
      });  
      indexul += "</ul>";
      const indexdiv = document.querySelector("#Index");
      indexdiv.innerHTML = indexul;      
      preventDefaultLinks();      
    });
        
  }
}


/*    
.then((response) => response.text())
.then((text) => {
links += "<li class='flow-layout'><a href='./" + l + "'>" +  l.slice(0, -3).replaceAll("_"," ").split("/").pop();
links += "</a><div class=\"outerthumb\"><div class=\"thumb\">";

const base = "./" + l.split("/").slice(0,-1).join("/") + "/";
marked.use(markedBaseUrl.baseUrl('/'));
marked.use(markedBaseUrl.baseUrl(base));
links += marked.parse(text);
links += "</div></div></li>";

}).then(()=>{
  
});



});


});
  }
  else {
    const myRequest = new Request(`${f}`);
    fetch(myRequest)
      .then((response) => response.text())
      .then((text) => {
        const myArticle = document.querySelector("#Index");
        marked.use(markedBaseUrl.baseUrl('/'));
        const base = "." + f.split("/").slice(0,-1).join("/") + "/";
        marked.use(markedBaseUrl.baseUrl(base));
        myArticle.innerHTML = marked.parse(text);
      });
  }
}
*/
</script>
</body>
</html>
